<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G3 RMS Professional Training Simulator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .game-content {
            padding: 30px;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #28a745);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .scenario-header {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-left: 5px solid #007bff;
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 0 10px 10px 0;
            animation: slideIn 0.5s ease-out;
        }
        
        .scenario-header h2 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.8em;
        }
        
        .scenario-type {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        
        .alert-banner {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .alert-banner.show {
            display: block;
        }
        
        .alert-banner.critical {
            background: #f8d7da;
            border-color: #dc3545;
        }
        
        .data-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .data-panel {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .data-panel h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #007bff;
            padding-bottom: 8px;
        }
        
        .chart-container {
            position: relative;
            height: 280px;
            margin: 20px 0;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }
        
        .metric {
            text-align: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #007bff;
        }
        
        .metric-label {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 5px;
        }
        
        .g3-recommendation {
            background: linear-gradient(135deg, #e8f5e8, #f0f8ff);
            border: 2px solid #28a745;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
            position: relative;
        }
        
        .g3-badge {
            position: absolute;
            top: -12px;
            left: 20px;
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .recommendation-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .recommendation-header h3 {
            color: #155724;
            margin-right: 15px;
        }
        
        .confidence-score {
            background: #155724;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .recommended-rates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .rate-item {
            text-align: center;
            padding: 15px;
            background: rgba(255,255,255,0.7);
            border-radius: 8px;
            border: 1px solid #28a745;
            transition: all 0.3s ease;
        }
        
        .rate-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .rate-value {
            font-size: 2em;
            font-weight: bold;
            color: #28a745;
        }
        
        .rate-label {
            font-size: 0.9em;
            color: #155724;
            margin-top: 5px;
        }
        
        .decision-panel {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .decision-panel h3 {
            color: #856404;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
        }
        
        .decision-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .decision-btn {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .decision-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0,123,255,0.3);
        }
        
        .decision-btn.accept {
            background: linear-gradient(135deg, #28a745, #1e7e34);
        }
        
        .decision-btn.accept:hover {
            box-shadow: 0 12px 25px rgba(40,167,69,0.3);
        }
        
        .decision-btn.selected {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.3);
        }
        
        .override-panel {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
            border: 2px dashed #ffc107;
        }
        
        .override-reason {
            margin-bottom: 15px;
        }
        
        .override-reason select {
            width: 100%;
            padding: 10px;
            border: 2px solid #007bff;
            border-radius: 5px;
            font-size: 1em;
        }
        
        .rate-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .rate-input {
            text-align: center;
        }
        
        .rate-input input {
            width: 100%;
            padding: 12px;
            font-size: 1.2em;
            border: 2px solid #007bff;
            border-radius: 8px;
            text-align: center;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            display: block;
            margin: 20px auto 0;
            font-weight: bold;
        }
        
        .results {
            display: none;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border: 2px solid #28a745;
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            animation: slideIn 0.5s ease-out;
        }
        
        .results.poor {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border-color: #dc3545;
        }
        
        .score-display {
            text-align: center;
            margin: 20px 0;
        }
        
        .score {
            font-size: 3em;
            font-weight: bold;
            color: #28a745;
        }
        
        .score.poor {
            color: #dc3545;
        }
        
        .next-scenario-btn {
            background: linear-gradient(135deg, #6f42c1, #5a2d91);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 10px;
            font-size: 1.3em;
            cursor: pointer;
            margin-top: 25px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            font-weight: bold;
        }
        
        .competitive-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .competitive-table th,
        .competitive-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        
        .competitive-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .competitive-table tr {
            transition: background-color 0.2s ease;
        }
        
        .competitive-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .learning-point {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .learning-point strong {
            color: #1565c0;
        }
        
        .feedback-panel {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #007bff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }
        
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 5px currentColor; }
            to { text-shadow: 0 0 10px currentColor, 0 0 15px currentColor; }
        }
        
        .metric-value.positive {
            color: #28a745 !important;
            animation: glow 2s infinite alternate;
        }
        
        .metric-value.negative {
            color: #dc3545 !important;
            animation: glow 2s infinite alternate;
        }
        
        .metric-value.warning {
            color: #ffc107 !important;
            animation: glow 2s infinite alternate;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>G3 RMS Professional Training Simulator</h1>
            <p>Master the art of revenue optimization - Learn when to trust the system vs. when human insight adds value</p>
        </div>
        
        <div class="game-content">
            <!-- Progress indicator -->
            <div style="background: white; padding: 15px; margin-bottom: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span style="font-weight: bold; color: #2c3e50;">Training Progress</span>
                    <span id="progressText" style="color: #6c757d;">Scenario 1 of 15</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 6.67%;"></div>
                </div>
            </div>
            
            <div class="scenario-header">
                <div class="scenario-type" id="scenarioType">Trust Scenario</div>
                <h2 id="scenarioTitle">Morning Revenue Review - Business Hotel</h2>
                <p id="scenarioDescription">It's 8:00 AM and you're reviewing G3's overnight processing. The system has analyzed booking pace, competitor actions, and demand patterns to update recommendations for the next 90 days.</p>
            </div>
            
            <div class="alert-banner" id="alertBanner">
                <strong>G3 Information Manager Alert:</strong> <span id="alertText"></span>
            </div>
            
            <div class="data-grid">
                <div class="data-panel">
                    <h3>📊 Running 28 DOW Performance</h3>
                    <div class="metrics-grid">
                        <div class="metric">
                            <div class="metric-value" id="avgOccupancy">82%</div>
                            <div class="metric-label">Avg Occupancy</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="avgADR">$185</div>
                            <div class="metric-label">Avg ADR</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="avgRevPAR">$152</div>
                            <div class="metric-label">Avg RevPAR</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="strIndex">108.5</div>
                            <div class="metric-label">STR RGI</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="forecastAccuracy">94%</div>
                            <div class="metric-label">Forecast Accuracy</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="systemAdoption">87%</div>
                            <div class="metric-label">G3 Adoption</div>
                        </div>
                    </div>
                </div>
                
                <div class="data-panel">
                    <h3>📈 Demand Forecast (Next 14 Days)</h3>
                    <div class="chart-container">
                        <canvas id="demandChart"></canvas>
                    </div>
                </div>
                
                <div class="data-panel">
                    <h3>🏨 Competitive Intelligence</h3>
                    <table class="competitive-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Rate Trend</th>
                                <th>Availability</th>
                                <th>Last Update</th>
                            </tr>
                        </thead>
                        <tbody id="competitiveData">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="data-grid">
                <div class="data-panel">
                    <h3>💰 Price Sensitivity Analysis</h3>
                    <div class="chart-container">
                        <canvas id="sensitivityChart"></canvas>
                    </div>
                </div>
                
                <div class="data-panel">
                    <h3>📅 Booking Pace Comparison</h3>
                    <div class="chart-container">
                        <canvas id="paceChart"></canvas>
                    </div>
                </div>
                
                <div class="data-panel">
                    <h3>🎯 Key Performance Indicators</h3>
                    <div class="metrics-grid">
                        <div class="metric">
                            <div class="metric-value" id="revenueOpportunity">+$2,340</div>
                            <div class="metric-label">Revenue Opportunity</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="systemROI">312%</div>
                            <div class="metric-label">G3 ROI</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="overrideRate">8%</div>
                            <div class="metric-label">Override Rate</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="alertCount">2</div>
                            <div class="metric-label">Active Alerts</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="g3-recommendation">
                <div class="g3-badge">G3 RECOMMENDATION</div>
                <div class="recommendation-header">
                    <h3>Room Type Pricing Optimization</h3>
                    <div class="confidence-score" id="confidenceScore">High Confidence</div>
                </div>
                <p id="recommendationReason">Based on 24-hour demand analysis, competitor positioning, and booking pace trends</p>
                
                <div class="recommended-rates" id="recommendedRates">
                </div>
            </div>
            
            <div class="decision-panel">
                <h3>Your Decision</h3>
                <div class="decision-options">
                    <button class="decision-btn accept" onclick="selectDecision('accept')">
                        ✓ Accept G3 Recommendations
                    </button>
                    <button class="decision-btn" onclick="selectDecision('investigate')">
                        🔍 Investigate Further
                    </button>
                    <button class="decision-btn" onclick="selectDecision('override')">
                        ⚠️ Override System
                    </button>
                </div>
                
                <div class="override-panel" id="overridePanel">
                    <div class="override-reason">
                        <label><strong>Override Reason (Required):</strong></label>
                        <select id="overrideReason">
                            <option value="">Select a reason...</option>
                            <option value="external_event">External event not in system</option>
                            <option value="guest_experience">Guest experience priority</option>
                            <option value="competitive_intel">New competitive intelligence</option>
                            <option value="business_strategy">Strategic business decision</option>
                            <option value="group_commitment">Group contract commitment</option>
                            <option value="maintenance_issue">Property maintenance issue</option>
                        </select>
                    </div>
                    
                    <div class="rate-input-grid" id="rateInputs">
                    </div>
                    
                    <button class="submit-btn" onclick="submitDecision()">Submit Override</button>
                </div>
            </div>
            
            <div class="results" id="resultsPanel">
                <h3>Results & Learning</h3>
                <div id="resultText"></div>
                <div class="score-display">
                    <div>Performance Score: <span class="score" id="scoreValue">85</span>/100</div>
                </div>
                <div class="learning-point" id="learningPoint"></div>
                <button class="next-scenario-btn" onclick="nextScenario()">Next Scenario</button>
            </div>
        </div>
    </div>

    <script>
        let currentScenario = 0;
        let totalScore = 0;
        let selectedDecision = '';
        let demandChart, sensitivityChart, paceChart;
        
        const scenarios = [
            {
                type: "Trust Scenario",
                title: "Morning Revenue Review - Business Hotel",
                description: "G3 has processed overnight data and updated recommendations. All market signals are within normal parameters.",
                isException: false,
                hasAlert: false,
                confidence: "High Confidence",
                performance: {
                    avgOccupancy: "82%",
                    avgADR: "$185",
                    avgRevPAR: "$152",
                    strIndex: "108.5",
                    forecastAccuracy: "94%",
                    systemAdoption: "87%",
                    revenueOpportunity: "+$2,340",
                    systemROI: "312%",
                    overrideRate: "8%",
                    alertCount: "2"
                },
                competitors: [
                    {property: "Your Hotel", trend: "↗️ +$5 (2h)", availability: "Available", update: "2h ago"},
                    {property: "Business Center Inn", trend: "➡️ Stable", availability: "Limited", update: "4h ago"},
                    {property: "Corporate Suites", trend: "↗️ +$8 (6h)", availability: "Available", update: "6h ago"},
                    {property: "Downtown Express", trend: "↘️ -$3 (8h)", availability: "Sold Out", update: "8h ago"}
                ],
                roomTypes: [
                    {name: "Standard King", currentRate: 189, recommendedRate: 195, reasoning: "Strong corporate demand"},
                    {name: "Deluxe Queen", currentRate: 209, recommendedRate: 215, reasoning: "Limited inventory"},
                    {name: "Executive Suite", currentRate: 289, recommendedRate: 289, reasoning: "Optimal positioning"}
                ],
                demandData: [95, 88, 92, 78, 85, 90, 88, 82, 75, 70, 68, 72, 76, 80],
                revenueData: [18050, 17760, 17940, 15210, 16575, 17550, 17160, 15990, 14625, 13650, 13260, 14040, 14820, 15600],
                paceData: [120, 115, 110, 108, 105, 102, 98, 95, 90, 85, 82, 78, 75, 70],
                optimalDecision: "accept",
                feedback: {
                    accept: "Excellent! G3's recommendations are based on comprehensive data analysis. Trusting the system in normal conditions allows you to focus on strategic initiatives.",
                    investigate: "Good practice, but G3's high confidence and 94% forecast accuracy indicate the recommendations are already well-founded.",
                    override: "G3 already considered all available market data. Unnecessary overrides reduce system learning and your efficiency."
                },
                learning: "G3 processes over 100 forecasting models continuously. In normal market conditions, the system's recommendations optimize revenue better than human intuition."
            },
            {
                type: "Investigation Scenario", 
                title: "Unusual Booking Pattern Detected",
                description: "G3 shows conflicting signals: strong demand forecast but declining booking pace. The system recommendation seems conservative.",
                isException: false,
                hasAlert: true,
                alertText: "Booking pace variance detected - 15% below forecast for next 7 days",
                alertType: "warning",
                confidence: "Medium Confidence",
                performance: {
                    avgOccupancy: "76%",
                    avgADR: "$165",
                    avgRevPAR: "$125",
                    strIndex: "98.2",
                    forecastAccuracy: "89%",
                    systemAdoption: "91%",
                    revenueOpportunity: "+$1,890",
                    systemROI: "287%",
                    overrideRate: "12%",
                    alertCount: "3"
                },
                competitors: [
                    {property: "Your Hotel", trend: "➡️ Stable", availability: "Available", update: "1h ago"},
                    {property: "Resort Marina", trend: "↗️ +$12 (4h)", availability: "Limited", update: "4h ago"},
                    {property: "Beachfront Lodge", trend: "↗️ +$18 (6h)", availability: "Very Limited", update: "3h ago"},
                    {property: "Coastal Inn", trend: "➡️ Stable", availability: "Available", update: "5h ago"}
                ],
                roomTypes: [
                    {name: "Ocean View", currentRate: 245, recommendedRate: 255, reasoning: "Moderate demand signal"},
                    {name: "Poolside King", currentRate: 195, recommendedRate: 205, reasoning: "Booking pace concern"},
                    {name: "Garden Suite", currentRate: 325, recommendedRate: 325, reasoning: "Luxury segment stable"}
                ],
                demandData: [65, 70, 68, 72, 75, 78, 80, 82, 78, 75, 72, 68, 65, 62],
                revenueData: [15925, 17150, 16660, 17640, 18375, 19110, 19600, 20090, 19110, 18375, 17640, 16660, 15925, 15190],
                paceData: [85, 82, 78, 75, 72, 68, 65, 62, 58, 55, 52, 48, 45, 42],
                optimalDecision: "investigate",
                feedback: {
                    accept: "Risky choice. The medium confidence and booking pace variance warrant investigation before committing to these rates.",
                    investigate: "Perfect! The conflicting signals warrant investigation. This is exactly when revenue managers should dig deeper before deciding.",
                    override: "Without understanding the cause of pace variance, overriding could worsen the situation. Investigation first, then decide."
                },
                learning: "When G3 shows 'Medium Confidence' or unusual patterns, use the Investigator feature to understand the reasoning before making decisions."
            },
            {
                type: "Override Scenario",
                title: "Breaking: Major Tech Conference Announced",
                description: "URGENT: Tech Summit 2025 just announced for your city next week - 5,000 attendees expected. This event isn't in G3's historical data.",
                isException: true,
                hasAlert: true,
                alertText: "EXTERNAL EVENT ALERT: Tech Summit 2025 announced 30 minutes ago - Major demand impact expected",
                alertType: "critical",
                confidence: "High Confidence",
                performance: {
                    avgOccupancy: "68%",
                    avgADR: "$175",
                    avgRevPAR: "$119",
                    strIndex: "102.1",
                    forecastAccuracy: "96%",
                    systemAdoption: "85%",
                    revenueOpportunity: "+$3,250",
                    systemROI: "298%",
                    overrideRate: "6%",
                    alertCount: "1"
                },
                competitors: [
                    {property: "Your Hotel", trend: "➡️ Stable", availability: "Available", update: "30min ago"},
                    {property: "Convention Center Hotel", trend: "🚀 +$45 (30min)", availability: "Very Limited", update: "20min ago"},
                    {property: "Tech District Inn", trend: "🚀 +$35 (25min)", availability: "Limited", update: "25min ago"},
                    {property: "Business Plaza", trend: "🚀 +$28 (40min)", availability: "Available", update: "35min ago"}
                ],
                roomTypes: [
                    {name: "Standard King", currentRate: 175, recommendedRate: 180, reasoning: "Normal demand patterns"},
                    {name: "Business Queen", currentRate: 195, recommendedRate: 200, reasoning: "Corporate segment growth"},
                    {name: "Executive Suite", currentRate: 275, recommendedRate: 285, reasoning: "Premium positioning"}
                ],
                demandData: [45, 50, 48, 52, 55, 58, 60, 62, 58, 55, 52, 48, 45, 42],
                revenueData: [7875, 9750, 9360, 10140, 10725, 11310, 11700, 12090, 11310, 10725, 10140, 9360, 8775, 8190],
                paceData: [40, 38, 35, 32, 30, 28, 25, 22, 20, 18, 15, 12, 10, 8],
                optimalDecision: "override",
                externalInfo: "⚡ BREAKING: TechSummit 2025 announced 30 minutes ago - 5,000 attendees, sold out venue, hotels already raising rates citywide",
                feedback: {
                    accept: "G3 doesn't know about the conference yet! This is exactly when human intelligence adds value. You missed a major revenue opportunity.",
                    investigate: "Good instinct, but immediate action needed. Competitors are already raising rates. Investigation can happen after capturing demand.",
                    override: "Perfect! You recognized information G3 doesn't have. This is legitimate override territory - external events require human intervention."
                },
                learning: "Override scenarios involve information G3 cannot access: breaking news, last-minute events, or strategic decisions beyond revenue optimization."
            },
            {
                type: "Data Quality Alert",
                title: "Forecast Accuracy Warning",
                description: "G3's forecast accuracy has dropped to 78% this week. The system is flagging potential data quality issues that require immediate attention.",
                isException: true,
                hasAlert: true,
                alertText: "SYSTEM ALERT: Forecast accuracy below threshold (78% vs 90+ target) - Data quality investigation required",
                alertType: "critical",
                confidence: "Low Confidence",
                performance: {
                    avgOccupancy: "84%",
                    avgADR: "$167",
                    avgRevPAR: "$140",
                    strIndex: "103.2",
                    forecastAccuracy: "78%",
                    systemAdoption: "91%",
                    revenueOpportunity: "+$890",
                    systemROI: "285%",
                    overrideRate: "23%",
                    alertCount: "4"
                },
                competitors: [
                    {property: "Your Hotel", trend: "⚠️ Data issues", availability: "Available", update: "1h ago"},
                    {property: "City Center", trend: "➡️ Stable", availability: "Limited", update: "2h ago"},
                    {property: "Business Plaza", trend: "↗️ +$7 (3h)", availability: "Available", update: "3h ago"},
                    {property: "Urban Lodge", trend: "➡️ Stable", availability: "Available", update: "4h ago"}
                ],
                roomTypes: [
                    {name: "Standard King", currentRate: 165, recommendedRate: 170, reasoning: "Low confidence estimate"},
                    {name: "Business Queen", currentRate: 185, recommendedRate: 185, reasoning: "Maintain current rate"},
                    {name: "Executive Suite", currentRate: 245, recommendedRate: 250, reasoning: "Uncertain demand signal"}
                ],
                demandData: [82, 78, 85, 79, 88, 84, 81, 86, 83, 87, 79, 82, 85, 80],
                revenueData: [13530, 13026, 14025, 13041, 14520, 13860, 13365, 14190, 13695, 14355, 13041, 13530, 14025, 13200],
                paceData: [98, 95, 102, 96, 105, 101, 97, 103, 99, 104, 96, 98, 102, 96],
                optimalDecision: "investigate",
                externalInfo: "⚠️ SYSTEM DIAGNOSIS: PMS integration showing inconsistent pickup data. Group bookings may not be flowing correctly. Check: walkups vs no-shows, group block accuracy, and third-party channel data.",
                feedback: {
                    accept: "Dangerous! When G3 shows 'Low Confidence' and poor forecast accuracy, accepting recommendations without investigation can compound errors.",
                    investigate: "Perfect! Data quality issues require immediate attention. G3 cannot optimize effectively with bad inputs - 'Garbage In, Garbage Out' applies.",
                    override: "Override won't fix the underlying data problem. Investigation and correction of data issues should come before pricing decisions."
                },
                learning: "G3's most common failure mode is data quality issues. When forecast accuracy drops below 85%, investigate PMS integration, group blocks, and channel data before making pricing decisions."
            },
            {
                type: "Room Type Optimization",
                title: "Independent Room Category Pricing",
                description: "G3 recommends different rate changes across room types that break traditional pricing hierarchy. Suites going down while standards go up.",
                isException: false,
                hasAlert: false,
                confidence: "High Confidence",
                performance: {
                    avgOccupancy: "73%",
                    avgADR: "$198",
                    avgRevPAR: "$145",
                    strIndex: "107.3",
                    forecastAccuracy: "94%",
                    systemAdoption: "88%",
                    revenueOpportunity: "+$3,450",
                    systemROI: "329%",
                    overrideRate: "9%",
                    alertCount: "0"
                },
                competitors: [
                    {property: "Your Hotel", trend: "🎯 Category optimization", availability: "Mixed", update: "45min ago"},
                    {property: "Luxury Inn", trend: "➡️ Hierarchy pricing", availability: "Available", update: "2h ago"},
                    {property: "Premium Suites", trend: "↗️ +$15 (3h)", availability: "Limited", update: "3h ago"},
                    {property: "Business Hotel", trend: "➡️ Standard approach", availability: "Available", update: "1h ago"}
                ],
                roomTypes: [
                    {name: "Standard King", currentRate: 185, recommendedRate: 195, reasoning: "High corporate demand"},
                    {name: "Deluxe Queen", currentRate: 205, recommendedRate: 215, reasoning: "Limited availability"},
                    {name: "Junior Suite", currentRate: 275, recommendedRate: 265, reasoning: "Low suite demand"},
                    {name: "Executive Suite", currentRate: 325, recommendedRate: 315, reasoning: "Stimulate luxury bookings"}
                ],
                demandData: [88, 85, 82, 79, 76, 73, 70, 68, 65, 62, 60, 58, 55, 52],
                revenueData: [17248, 17085, 16810, 16185, 15504, 14599, 13720, 13328, 12675, 12214, 11700, 11368, 10725, 10140],
                paceData: [105, 102, 98, 95, 91, 87, 83, 79, 75, 71, 68, 64, 60, 56],
                optimalDecision: "accept",
                externalInfo: "📊 G3 ROOM-TYPE ANALYTICS: Independent category pricing maximizes total revenue by matching room-specific demand patterns rather than maintaining traditional rate spreads.",
                feedback: {
                    accept: "Brilliant! G3's room-type optimization prices categories independently based on actual demand, not traditional hierarchy rules. This maximizes total property revenue.",
                    investigate: "Investigation confirms G3's approach is correct. Breaking traditional hierarchy based on demand data often increases total revenue significantly.",
                    override: "Maintaining traditional hierarchy would leave money on the table. G3's category-specific optimization typically increases RevPAR by 3-7%."
                },
                learning: "G3's strongest feature is independent room-type pricing based on actual demand patterns rather than fixed hierarchy rules, often breaking traditional rate spreads to maximize total revenue."
            },
            {
                type: "Advanced Trust Scenario",
                title: "Length-of-Stay Optimization",
                description: "G3's sophisticated algorithms are optimizing multi-night stays, but the pricing looks counterintuitive - higher rates for longer stays during slow periods.",
                isException: false,
                hasAlert: false,
                confidence: "High Confidence",
                performance: {
                    avgOccupancy: "71%",
                    avgADR: "$142",
                    avgRevPAR: "$101",
                    strIndex: "96.4",
                    forecastAccuracy: "95%",
                    systemAdoption: "93%",
                    revenueOpportunity: "+$4,250",
                    systemROI: "318%",
                    overrideRate: "7%",
                    alertCount: "1"
                },
                competitors: [
                    {property: "Your Hotel", trend: "➡️ Optimizing LOS", availability: "Available", update: "30min ago"},
                    {property: "Resort Bay", trend: "➡️ Standard pricing", availability: "Available", update: "2h ago"},
                    {property: "Marina Lodge", trend: "↘️ Discount pricing", availability: "High Avail", update: "4h ago"},
                    {property: "Coastal Resort", trend: "➡️ Package focus", availability: "Available", update: "3h ago"}
                ],
                roomTypes: [
                    {name: "Ocean View 1-2N", currentRate: 145, recommendedRate: 155, reasoning: "Premium for short stays"},
                    {name: "Ocean View 3-4N", currentRate: 138, recommendedRate: 148, reasoning: "Balanced LOS pricing"},
                    {name: "Ocean View 5+N", currentRate: 132, recommendedRate: 142, reasoning: "Volume optimization"}
                ],
                demandData: [45, 52, 48, 65, 78, 85, 82, 79, 75, 68, 62, 58, 55, 50],
                revenueData: [6525, 7904, 7104, 9750, 11700, 12750, 12300, 11850, 11250, 10200, 9300, 8700, 8250, 7500],
                paceData: [65, 68, 64, 78, 89, 92, 88, 85, 80, 75, 70, 66, 62, 58],
                optimalDecision: "accept",
                externalInfo: "📊 G3 ADVANCED ANALYTICS: Length-of-stay optimization uses dynamic programming to price all stay durations simultaneously, maximizing total revenue across booking windows rather than simple nightly rates.",
                feedback: {
                    accept: "Excellent! G3's LOS optimization considers displacement effects and booking window behavior. The system maximizes total revenue, not just nightly ADR.",
                    investigate: "Good to investigate, but G3's length-of-stay algorithms are processing 100+ variables including displacement costs and booking probability curves.",
                    override: "G3's LOS pricing considers factors beyond intuition: opportunity costs, displacement effects, and total revenue optimization across all stay patterns."
                },
                learning: "Length-of-stay optimization represents G3's most sophisticated capability - pricing stay durations independently based on demand patterns and displacement effects."
            },
            {
                type: "Final Assessment",
                title: "Comprehensive Revenue Optimization Challenge",
                description: "Master-level scenario combining room-type optimization, competitive response, overbooking management, and stakeholder communication in one complex decision.",
                isException: false,
                hasAlert: true,
                alertText: "Multi-factor optimization opportunity: G3 has identified revenue enhancement across pricing, inventory, and competitive positioning",
                alertType: "warning",
                confidence: "High Confidence",
                performance: {
                    avgOccupancy: "87%",
                    avgADR: "$181",
                    avgRevPAR: "$157",
                    strIndex: "112.4",
                    forecastAccuracy: "96%",
                    systemAdoption: "91%",
                    revenueOpportunity: "+$6,250",
                    systemROI: "347%",
                    overrideRate: "8%",
                    alertCount: "7"
                },
                competitors: [
                    {property: "Your Hotel", trend: "🎯 G3 Optimized", availability: "Limited", update: "Current"},
                    {property: "Competitor A", trend: "📊 Manual pricing", availability: "Available", update: "2h ago"},
                    {property: "Competitor B", trend: "📈 Rate increases", availability: "Very Limited", update: "1h ago"},
                    {property: "Competitor C", trend: "📉 Promotional rates", availability: "High Avail", update: "3h ago"}
                ],
                roomTypes: [
                    {name: "Standard King", currentRate: 175, recommendedRate: 185, reasoning: "Multi-factor optimization"},
                    {name: "Business Queen", currentRate: 195, recommendedRate: 205, reasoning: "Independent category pricing"},
                    {name: "Executive Suite", currentRate: 265, recommendedRate: 255, reasoning: "Demand-based adjustment"},
                    {name: "Premium Suite", currentRate: 345, recommendedRate: 365, reasoning: "Luxury segment strength"}
                ],
                demandData: [88, 91, 94, 97, 100, 103, 106, 104, 101, 98, 95, 92, 89, 86],
                revenueData: [16368, 16926, 17484, 18042, 18600, 19158, 19716, 19344, 18786, 18228, 17670, 17112, 16554, 15996],
                paceData: [115, 118, 121, 124, 127, 130, 133, 131, 128, 125, 122, 119, 116, 113],
                optimalDecision: "accept",
                externalInfo: "🏆 COMPREHENSIVE ANALYSIS: G3 is simultaneously optimizing room categories, managing overbooking levels, responding to competitor actions, and forecasting demand across multiple time horizons.",
                feedback: {
                    accept: "Outstanding! You've demonstrated mastery of G3's comprehensive capabilities. Trusting the system's multi-dimensional optimization delivers maximum revenue performance.",
                    investigate: "Investigation confirms G3's sophisticated analysis across all revenue levers. The system's comprehensive approach outperforms manual optimization attempts.",
                    override: "Overriding G3's comprehensive optimization would require superhuman analytical capabilities. The system processes hundreds of variables simultaneously."
                },
                learning: "G3's true power lies in simultaneously optimizing multiple revenue variables that would be impossible for humans to calculate manually, delivering superior total performance."
            }
        ];
        
        function initializeScenario() {
            const scenario = scenarios[currentScenario];
            
            // Update progress indicator
            const progressPercent = ((currentScenario + 1) / scenarios.length) * 100;
            document.getElementById('progressFill').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `Scenario ${currentScenario + 1} of ${scenarios.length}`;
            
            // Update header
            document.getElementById('scenarioType').textContent = `${scenario.type} - ${currentScenario + 1}/${scenarios.length}`;
            document.getElementById('scenarioTitle').textContent = scenario.title;
            document.getElementById('scenarioDescription').textContent = scenario.description;
            
            // Handle alerts with enhanced styling
            const alertBanner = document.getElementById('alertBanner');
            if (scenario.hasAlert) {
                document.getElementById('alertText').textContent = scenario.alertText;
                alertBanner.className = `alert-banner show ${scenario.alertType || ''}`;
                
                // Add pulsing animation for critical alerts
                if (scenario.alertType === 'critical') {
                    alertBanner.style.animation = 'pulse 2s infinite';
                } else {
                    alertBanner.style.animation = 'none';
                }
            } else {
                alertBanner.className = 'alert-banner';
                alertBanner.style.animation = 'none';
            }
            
            // Update performance metrics with visual indicators
            Object.keys(scenario.performance).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = scenario.performance[key];
                    
                    // Add visual indicators for key metrics
                    if (key === 'forecastAccuracy') {
                        const accuracy = parseInt(scenario.performance[key]);
                        element.className = 'metric-value';
                        if (accuracy < 85) {
                            element.classList.add('negative');
                        } else if (accuracy >= 95) {
                            element.classList.add('positive');
                        }
                    }
                    
                    if (key === 'overrideRate') {
                        const overrideRate = parseInt(scenario.performance[key]);
                        element.className = 'metric-value';
                        if (overrideRate > 20) {
                            element.classList.add('negative');
                        } else if (overrideRate <= 10) {
                            element.classList.add('positive');
                        } else {
                            element.classList.add('warning');
                        }
                    }
                }
            });
            
            // Update competitive table
            const tableBody = document.getElementById('competitiveData');
            tableBody.innerHTML = '';
            scenario.competitors.forEach(comp => {
                const row = tableBody.insertRow();
                let trendClass = '';
                if (comp.trend.includes('↗️') || comp.trend.includes('🚀')) {
                    trendClass = 'style="color: #28a745; font-weight: bold;"';
                } else if (comp.trend.includes('↘️')) {
                    trendClass = 'style="color: #dc3545; font-weight: bold;"';
                } else if (comp.trend.includes('⚠️')) {
                    trendClass = 'style="color: #ffc107; font-weight: bold;"';
                }
                
                row.innerHTML = `
                    <td>${comp.property}</td>
                    <td ${trendClass}>${comp.trend}</td>
                    <td>${comp.availability}</td>
                    <td>${comp.update}</td>
                `;
            });
            
            // Update G3 recommendation
            const confidenceElement = document.getElementById('confidenceScore');
            confidenceElement.textContent = scenario.confidence;
            
            // Style confidence indicator
            if (scenario.confidence === 'High Confidence') {
                confidenceElement.style.backgroundColor = '#28a745';
                confidenceElement.style.color = 'white';
            } else if (scenario.confidence === 'Medium Confidence') {
                confidenceElement.style.backgroundColor = '#ffc107';
                confidenceElement.style.color = '#000';
            } else {
                confidenceElement.style.backgroundColor = '#dc3545';
                confidenceElement.style.color = 'white';
            }
            
            // Update recommendation reasoning
            document.getElementById('recommendationReason').textContent = 
                scenario.roomTypes.length > 1 ? 
                "Multi-room type optimization analyzing segment demand, competitive positioning, and booking patterns" : 
                scenario.roomTypes[0].reasoning || "Single room type optimization";
            
            // Update recommended rates with change indicators
            const ratesContainer = document.getElementById('recommendedRates');
            ratesContainer.innerHTML = '';
            scenario.roomTypes.forEach(room => {
                const change = room.recommendedRate - room.currentRate;
                const changeIndicator = change > 0 ? `+${change}` : change < 0 ? `-${Math.abs(change)}` : 'No change';
                const changeColor = change > 0 ? '#28a745' : change < 0 ? '#dc3545' : '#6c757d';
                
                const rateDiv = document.createElement('div');
                rateDiv.className = 'rate-item';
                rateDiv.innerHTML = `
                    <div class="rate-value">${room.recommendedRate}</div>
                    <div class="rate-label">${room.name}</div>
                    <div style="font-size: 0.8em; color: ${changeColor}; margin-top: 5px; font-weight: bold;">
                        ${changeIndicator}
                    </div>
                    <div style="font-size: 0.75em; color: #666; margin-top: 3px;">
                        ${room.reasoning}
                    </div>
                `;
                ratesContainer.appendChild(rateDiv);
            });
            
            // Add external info if exists
            const existingInfo = document.querySelector('.g3-recommendation .learning-point');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            if (scenario.externalInfo) {
                const infoDiv = document.createElement('div');
                infoDiv.className = 'learning-point';
                infoDiv.innerHTML = scenario.externalInfo;
                document.querySelector('.g3-recommendation').appendChild(infoDiv);
            }
            
            createCharts(scenario);
            
            // Reset decision panel
            document.getElementById('overridePanel').style.display = 'none';
            document.getElementById('resultsPanel').style.display = 'none';
            selectedDecision = '';
            
            // Clear any previous styling on decision buttons
            document.querySelectorAll('.decision-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
        }
        
        function createCharts(scenario) {
            // Destroy existing charts
            if (demandChart) demandChart.destroy();
            if (sensitivityChart) sensitivityChart.destroy();
            if (paceChart) paceChart.destroy();
            
            const labels = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7', 'Day 8', 'Day 9', 'Day 10', 'Day 11', 'Day 12', 'Day 13', 'Day 14'];
            
            // Demand forecast chart
            const demandCtx = document.getElementById('demandChart').getContext('2d');
            demandChart = new Chart(demandCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Forecasted Demand',
                        data: scenario.demandData,
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Rooms' } },
                        x: { title: { display: true, text: 'Days Ahead' } }
                    }
                }
            });
            
            // Revenue optimization chart
            const sensitivityCtx = document.getElementById('sensitivityChart').getContext('2d');
            sensitivityChart = new Chart(sensitivityCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Projected Revenue',
                        data: scenario.revenueData,
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            title: { display: true, text: 'Daily Revenue ($)' },
                            ticks: { callback: value => ' + value.toLocaleString() }
                        },
                        x: { title: { display: true, text: 'Days Ahead' } }
                    }
                }
            });
            
            // Booking pace chart
            const paceCtx = document.getElementById('paceChart').getContext('2d');
            paceChart = new Chart(paceCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Booking Pace vs LY',
                        data: scenario.paceData,
                        borderColor: '#ffc107',
                        backgroundColor: 'rgba(255, 193, 7, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            title: { display: true, text: 'Pace Index (%)' } 
                        },
                        x: { title: { display: true, text: 'Days Ahead' } }
                    }
                }
            });
        }
        
        function selectDecision(decision) {
            selectedDecision = decision;
            
            // Visual feedback for button selection
            document.querySelectorAll('.decision-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            const overridePanel = document.getElementById('overridePanel');
            
            if (decision === 'override') {
                overridePanel.style.display = 'block';
                overridePanel.style.animation = 'slideIn 0.5s ease-out';
                setupOverrideInputs();
            } else {
                overridePanel.style.display = 'none';
                if (decision === 'investigate') {
                    showInvestigationProcess();
                } else {
                    submitDecision();
                }
            }
        }
        
        function showInvestigationProcess() {
            const scenario = scenarios[currentScenario];
            
            // Create investigation modal
            const investigationDiv = document.createElement('div');
            investigationDiv.className = 'feedback-panel';
            investigationDiv.style.position = 'fixed';
            investigationDiv.style.top = '50%';
            investigationDiv.style.left = '50%';
            investigationDiv.style.transform = 'translate(-50%, -50%)';
            investigationDiv.style.zIndex = '1000';
            investigationDiv.style.maxWidth = '600px';
            investigationDiv.style.maxHeight = '80vh';
            investigationDiv.style.overflow = 'auto';
            investigationDiv.style.boxShadow = '0 20px 40px rgba(0,0,0,0.3)';
            
            let investigationContent = `
                <h3 style="color: #007bff; margin-bottom: 20px;">🔍 G3 Investigation Results</h3>
                <div style="background: white; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <strong>System Analysis:</strong><br>
                    Confidence Level: ${scenario.confidence}<br>
                    Forecast Accuracy: ${scenario.performance.forecastAccuracy}<br>
                    Current Override Rate: ${scenario.performance.overrideRate}<br>
                </div>
            `;
            
            // Add scenario-specific investigation insights
            if (scenario.type.includes('Data Quality')) {
                investigationContent += `
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #ffc107;">
                        <strong>⚠️ Data Quality Issues Detected:</strong><br>
                        • PMS integration showing inconsistencies<br>
                        • Forecast accuracy below threshold<br>
                        • Immediate technical attention required
                    </div>
                `;
            } else if (scenario.confidence === 'Medium Confidence') {
                investigationContent += `
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #ffc107;">
                        <strong>📊 Mixed Signals Detected:</strong><br>
                        • Booking pace variance: ${scenario.alertText || 'Pattern inconsistencies noted'}<br>
                        • Consider market factors not in historical data<br>
                        • Review competitor actions in past 24 hours
                    </div>
                `;
            } else {
                investigationContent += `
                    <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #28a745;">
                        <strong>✅ System Analysis Confirms:</strong><br>
                        • All indicators within normal parameters<br>
                        • High confidence in recommendations<br>
                        • Standard market conditions detected
                    </div>
                `;
            }
            
            investigationContent += `
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #2196f3;">
                    <strong>📈 Key Factors G3 Considered:</strong><br>
                    • ${scenario.roomTypes.length} room types analyzed independently<br>
                    • Competitive intelligence from ${scenario.competitors.length} properties<br>
                    • 14-day forward demand forecast<br>
                    • Price sensitivity and booking pace analysis
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="closeInvestigation(); submitDecision();" 
                            style="background: #007bff; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 1.1em; cursor: pointer;">
                        Continue with Decision
                    </button>
                </div>
            `;
            
            investigationDiv.innerHTML = investigationContent;
            
            // Add backdrop
            const backdrop = document.createElement('div');
            backdrop.style.position = 'fixed';
            backdrop.style.top = '0';
            backdrop.style.left = '0';
            backdrop.style.width = '100%';
            backdrop.style.height = '100%';
            backdrop.style.backgroundColor = 'rgba(0,0,0,0.5)';
            backdrop.style.zIndex = '999';
            backdrop.onclick = () => closeInvestigation();
            
            document.body.appendChild(backdrop);
            document.body.appendChild(investigationDiv);
            
            window.currentInvestigation = { backdrop, investigationDiv };
        }
        
        function closeInvestigation() {
            if (window.currentInvestigation) {
                document.body.removeChild(window.currentInvestigation.backdrop);
                document.body.removeChild(window.currentInvestigation.investigationDiv);
                window.currentInvestigation = null;
            }
        }
        
        function setupOverrideInputs() {
            const scenario = scenarios[currentScenario];
            const rateInputs = document.getElementById('rateInputs');
            rateInputs.innerHTML = '';
            
            scenario.roomTypes.forEach((room, index) => {
                const inputDiv = document.createElement('div');
                inputDiv.className = 'rate-input';
                inputDiv.innerHTML = `
                    <label>${room.name}</label>
                    <input type="number" id="override_${index}" value="${room.recommendedRate}" min="50" max="500" step="5">
                `;
                rateInputs.appendChild(inputDiv);
            });
        }
        
        function submitDecision() {
            const scenario = scenarios[currentScenario];
            let score = 0;
            let feedback = '';
            let learningPoint = '';
            let bonusPoints = 0;
            
            // Enhanced scoring system based on G3 RMS principles
            if (selectedDecision === 'accept') {
                if (scenario.optimalDecision === 'accept') {
                    score = 100;
                    // Bonus for trusting system during normal operations
                    if (scenario.confidence === "High Confidence" && parseInt(scenario.performance.forecastAccuracy) >= 90) {
                        bonusPoints = 10;
                    }
                    feedback = scenario.feedback.accept;
                } else if (scenario.optimalDecision === 'override') {
                    score = 25; // Penalty for missing critical override scenarios
                    feedback = `❌ ${scenario.feedback.accept} This was a critical override scenario where human intelligence was essential.`;
                } else {
                    score = 75; // Reasonable but not optimal
                    feedback = scenario.feedback.accept;
                }
            } else if (selectedDecision === 'investigate') {
                if (scenario.optimalDecision === 'investigate') {
                    score = 100;
                    // Bonus for investigating when confidence is medium/low
                    if (scenario.confidence === "Medium Confidence" || scenario.confidence === "Low Confidence") {
                        bonusPoints = 15;
                    }
                    feedback = scenario.feedback.investigate;
                } else if (scenario.optimalDecision === 'accept') {
                    score = 85; // Good practice, slightly inefficient
                    feedback = `✓ ${scenario.feedback.investigate || "Good practice to investigate, though G3's recommendation was already optimal."}`;
                } else {
                    score = 90; // Investigation before override is wise
                    feedback = scenario.feedback.investigate || "Good investigative instincts! Understanding the data before overriding is always wise.";
                }
            } else if (selectedDecision === 'override') {
                const overrideReason = document.getElementById('overrideReason').value;
                
                if (!overrideReason) {
                    alert('Please select an override reason before submitting.');
                    return;
                }
                
                if (scenario.optimalDecision === 'override') {
                    score = 100;
                    // Bonus for proper override reasoning
                    if (overrideReason === 'external_event' && scenario.type.includes('Override')) {
                        bonusPoints = 20;
                    }
                    feedback = scenario.feedback.override;
                } else {
                    // Penalties based on override frequency and system performance
                    const currentOverrideRate = parseInt(scenario.performance.overrideRate);
                    const forecastAccuracy = parseInt(scenario.performance.forecastAccuracy);
                    
                    if (currentOverrideRate > 15 && forecastAccuracy > 90) {
                        score = 10; // Heavy penalty for excessive overriding
                        feedback = `❌ ${scenario.feedback.override} Your override rate is already ${currentOverrideRate}% - excessive overriding reduces G3's learning effectiveness.`;
                    } else {
                        score = 20;
                        feedback = scenario.feedback.override;
                    }
                }
            }
            
            // Apply scenario-specific penalties and bonuses
            if (scenario.type === "Data Quality Alert" && selectedDecision !== 'investigate') {
                score = Math.max(10, score - 30); // Major penalty for ignoring data quality issues
                feedback += "\n\n⚠️ CRITICAL: Data quality issues must be addressed immediately - they compound over time!";
            }
            
            if (scenario.hasAlert && scenario.alertType === "critical" && selectedDecision === 'accept') {
                score = Math.max(15, score - 25); // Penalty for ignoring critical alerts
            }
            
            // Calculate final score with bonuses
            const finalScore = Math.min(100, score + bonusPoints);
            learningPoint = scenario.learning;
            totalScore += finalScore;
            
            // Enhanced performance categorization
            let performanceCategory = '';
            let performanceMessage = '';
            
            if (finalScore >= 95) {
                performanceCategory = 'Expert Level';
                performanceMessage = '🏆 G3 RMS Expert! You understand when to trust the system and when human insight adds value.';
            } else if (finalScore >= 85) {
                performanceCategory = 'Proficient';
                performanceMessage = '✅ Strong performance! You\'re developing excellent G3 RMS judgment.';
            } else if (finalScore >= 70) {
                performanceCategory = 'Developing';
                performanceMessage = '📈 Good progress! Focus on understanding G3\'s confidence levels and alert priorities.';
            } else if (finalScore >= 50) {
                performanceCategory = 'Learning';
                performanceMessage = '📚 Keep learning! Remember: trust G3 for normal operations, override only with new information.';
            } else {
                performanceCategory = 'Needs Improvement';
                performanceMessage = '🎯 Focus needed! Review G3 RMS principles: system excels at data analysis, humans add strategic value.';
            }
            
            // Show results with enhanced feedback
            const resultsPanel = document.getElementById('resultsPanel');
            const resultText = document.getElementById('resultText');
            const scoreElement = document.getElementById('scoreValue');
            const learningElement = document.getElementById('learningPoint');
            
            resultText.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>${performanceCategory}:</strong> ${performanceMessage}
                </div>
                <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px; margin: 10px 0;">
                    ${feedback}
                </div>
                ${bonusPoints > 0 ? `<div style="color: #28a745; font-weight: bold; margin-top: 10px;">🌟 Bonus: +${bonusPoints} points for excellent judgment!</div>` : ''}
            `;
            
            scoreElement.textContent = finalScore;
            learningElement.innerHTML = `<strong>Key Learning:</strong> ${learningPoint}`;
            
            // Advanced performance analytics
            const currentScenarioNum = currentScenario + 1;
            const avgSoFar = Math.round(totalScore / currentScenarioNum);
            
            if (currentScenarioNum > 1) {
                learningElement.innerHTML += `<br><br><strong>Your Progress:</strong> Average score ${avgSoFar}/100 after ${currentScenarioNum} scenarios.`;
            }
            
            if (finalScore >= 80) {
                resultsPanel.className = 'results';
                scoreElement.className = 'score';
            } else {
                resultsPanel.className = 'results poor';
                scoreElement.className = 'score poor';
            }
            
            resultsPanel.style.display = 'block';
        }
        
        function nextScenario() {
            currentScenario++;
            if (currentScenario >= scenarios.length) {
                showFinalAssessment();
                return;
            }
            initializeScenario();
        }
        
        function showFinalAssessment() {
            const avgScore = Math.round(totalScore / scenarios.length);
            let certificationLevel = '';
            let professionalRecommendations = '';
            let nextSteps = '';
            
            // G3 RMS Certification-based assessment
            if (avgScore >= 95) {
                certificationLevel = "🏆 G3 RMS Expert - Ready for Advanced Implementation";
                professionalRecommendations = `
                    • Consider pursuing IDeaS G3 RMS Essentials Certification ($180)
                    • Qualified for advanced features: Enterprise Business Guidelines, Optix Analytics
                    • Ready to mentor other revenue managers in G3 best practices
                    • Consider HSMAI CRME/CRMA certification pathway
                `;
                nextSteps = "You demonstrate mastery of G3 RMS principles. Focus on strategic revenue management and team leadership.";
            } else if (avgScore >= 85) {
                certificationLevel = "✅ G3 RMS Proficient - Strong System Understanding";
                professionalRecommendations = `
                    • Recommended for IDeaS G3 RMS Essentials Certification
                    • Ready for advanced training on LOS optimization and room-type yielding
                    • Consider joining G3 user groups and industry forums
                    • Practice with What-If analysis tools for strategic planning
                `;
                nextSteps = "Excellent progress! Continue building expertise in advanced G3 features and competitive analysis.";
            } else if (avgScore >= 70) {
                certificationLevel = "📈 G3 RMS Developing - Building Core Skills";
                professionalRecommendations = `
                    • Complete comprehensive G3 RMS training before certification
                    • Focus on understanding forecast accuracy and confidence levels
                    • Practice daily workflow optimization and exception management
                    • Review G3 documentation on override best practices
                `;
                nextSteps = "Good foundation! Strengthen understanding of when to trust G3 vs. when human insight adds value.";
            } else if (avgScore >= 55) {
                certificationLevel = "📚 G3 RMS Learning - Foundational Development Needed";
                professionalRecommendations = `
                    • Enroll in basic G3 RMS training program immediately
                    • Work with experienced G3 user mentor for 3-6 months
                    • Focus on data quality management and PMS integration
                    • Study IDeaS documentation on forecasting and optimization
                `;
                nextSteps = "Focus on fundamentals: data quality, system trust in normal conditions, and proper override protocols.";
            } else {
                certificationLevel = "🎯 G3 RMS Beginner - Intensive Training Required";
                professionalRecommendations = `
                    • Mandatory comprehensive G3 RMS training before system access
                    • Minimum 6 months supervised operation with experienced user
                    • Complete Cornell eCornell Revenue Management program
                    • Focus on basic revenue management principles before advanced features
                `;
                nextSteps = "Significant development needed. Start with revenue management fundamentals before G3-specific training.";
            }
            
            let finalMessage = `G3 RMS TRAINING ASSESSMENT COMPLETE

🎯 OVERALL PERFORMANCE
Average Score: ${avgScore}/100
${certificationLevel}

💼 PROFESSIONAL RECOMMENDATIONS
${professionalRecommendations}

🚀 NEXT STEPS
${nextSteps}

📈 KEY G3 RMS PRINCIPLES TO REMEMBER:
• Trust G3's analytics for normal market conditions (80% acceptance rate target)
• Investigate when confidence is Medium/Low or when alerts are present
• Override only with information G3 doesn't have (external events, strategic decisions)
• Focus on data quality - G3 can't optimize with bad inputs
• Use G3's time savings for strategic work, not tactical overrides

🎓 CERTIFICATION PATH:
1. Master daily G3 operations (6-12 months experience)
2. Complete IDeaS G3 RMS Essentials Certification
3. Pursue advanced revenue management credentials (CRME/CRMA)
4. Specialize in advanced G3 features (Optix, EBG, Multi-property)

Would you like to restart the training scenarios for additional practice?`;
            
            alert(finalMessage);
            
            // Reset for additional practice
            if (confirm("Would you like to restart the training scenarios for additional practice?")) {
                currentScenario = 0;
                totalScore = 0;
                initializeScenario();
            }
        }
        
        // Initialize the game
        initializeScenario();
    </script>
</body>
</html>
